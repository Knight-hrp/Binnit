<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Binnit - Enjoy your stay</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=home"/>

        <link rel="stylesheet" href="/scrollbar.css">
        <link rel="stylesheet" href="/homepage_Styles.css">
        <link rel="stylesheet" href="/comments.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  </head>       

  <body>
    <div class="binnit-header">

        <div class="header-left">
            <div class="binnit-ico">
                <img src="/svg_icons/512px-removebg-preview.png">
            </div>
            
            <button onclick="window.location.href='/user/signup'">
                Sign Up
            </button>
             <button onclick="window.location.href='/user/Login'">
                Log In
            </button>
        </div>

       <div class="middleLogo">
            <svg width="400" height="100" viewBox="-12 -6 24 12" xmlns="http://www.w3.org/2000/svg">
                <path d="M -9 -4.8 H -4.2 V 0 H -9 V -4.8 M -8.4336 -0.5409 H -5.2786 V -1.0487 H -4.7365 V -2.6521 H -5.2975 V -3.1676 H -7.4051 V -4.2177 H -8.4431 V -0.5364 M -7.3864 -1.5793 H -5.8119 V -2.1021 H -7.3894 V -1.5793 M -3.7074 -0.5452 V -3.1672 H -2.6567 V -0.5452 H -3.7074 M -1.5965 -0.5453 H -0.5478 V -2.6427 H 0.5071 V -0.5391 H 1.5433 V -3.1621 H 1.0262 V -3.6849 H -1.6005 V -0.5454 M 2.6256 -0.542 H 3.6681 V -2.6508 H 4.7341 V -0.5331 H 5.7714 V -3.1621 H 5.2427 V -3.6879 H 2.6254 V -0.5409 M 6.2967 -3.1617 H 7.355 V -0.5388 H 6.2957 V -3.1657 M 8.9591 -4.7181 H 9.9826 V -3.6773 H 11.0343 V -2.6393 H 9.9933 V -1.574 H 11.0324 V -0.5426 H 9.4762 V -1.0647 H 8.9552 V -2.6537 H 8.3907 V -3.6758 H 8.954 V -4.7183 M 6.3824 -3.2754 H 6.6016 V -3.3839 H 6.7105 V -3.4897 H 6.8187 V -3.6 H 7.4687 V -3.7106 H 7.5748 V -3.8148 H 7.6866 V -3.9218 H 7.791 V -4.579 H 7.6865 V -4.6843 H 7.5762 V -4.7946 H 6.276 V -4.6842 H 6.1647 V -4.5763 H 6.0594 V -3.9283 H 6.1659 V -3.7072 H 6.2737 V -3.5993 H 6.3827 V -3.2757 M 6.3783 -4.2502 H 7.0338 V -4.1348 H 6.3758 V -4.2502 M 6.3798 -4.4627 H 7.2535 V -4.3548 H 6.3809 V -4.4616 M -3.5263 -3.3709 H -2.8234 V -3.4703 H -2.726 V -3.5667 H -2.6204 V -3.6723 H -2.5198 V -4.376 H -2.622 V -4.4763 H -2.7273 V -4.5768 H -2.8239 V -4.6757 V -4.6757 H -3.5259 V -4.5754 H -3.6292 V -4.4764 H -3.7298 V -4.3765 H -3.8282 V -3.6672 H -3.7277 V -3.567 H -3.6275 V -3.4677 H -3.5273 V -3.37 M -3.7258 -4.274 H -3.6279 V -4.376 H -3.5259 V -4.4711 H -3.4266 V -4.5732 H -2.9247 V -4.4683 H -2.824 V -4.3677 H -2.7247 V -4.2712 H -2.6269 V -3.7679 H -2.8226 V -3.8685 H -3.5231 V -3.7693 H -3.7258 V -4.274 M -3.527 -3.6707 H -3.4243 V -3.7726 H -2.9242 V -3.6647 H -2.8257 V -3.5722 H -2.9233 V -3.472 H -3.4251 V -3.5705 H -3.527 V -3.6698 M -3.3267 -4.4724 V -4.373 H -3.4277 V -4.071 H -3.3283 V -3.9666 H -3.0245 V -4.0678 H -2.921 V -4.3742 H -3.0241 V -4.4724 H -3.3271 M -3.2203 -4.3701 H -3.1273 V -4.2704 H -3.0248 V -4.1722 H -3.1274 V -4.075 H -3.2218 V -4.1727 H -3.3223 V -4.2702 H -3.2203 V -4.3708" fill="white" stroke="wihite" stroke-width="0"/>
            </svg>
            
        </div>

       
   

        <div class="right">
           <div class="search-bar">
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M788.38-127.85 535.92-380.31q-30 24.54-73.5 38.04t-83.88 13.5q-106.1 0-179.67-73.53-73.56-73.53-73.56-179.57 0-106.05 73.53-179.71 73.53-73.65 179.57-73.65 106.05 0 179.71 73.56Q631.77-688.1 631.77-582q0 42.69-13.27 83.69t-37.27 70.69l253.46 253.47-46.31 46.3ZM378.54-394.77q79.61 0 133.42-53.81 53.81-53.8 53.81-133.42 0-79.62-53.81-133.42-53.81-53.81-133.42-53.81-79.62 0-133.42 53.81-53.81 53.8-53.81 133.42 0 79.62 53.81 133.42 53.8 53.81 133.42 53.81Z"/></svg>
                <input type="search" class="search-bar-style" placeholder="Discover here..">
           </div>
        </div>



    </div>

    <div class="binnit-sidebar">
      <div class="space-for-scroll-window"></div>

        <nav id="sidebar">
            <ul>
            <li id="active">

                <div class="list-style">            
                    <a href="/">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M156-114v-487l324-242.77L804-601v487H566.15v-293.69h-172.3V-114H156Z"/></svg>
                    <span>Home</span>
                </a>
                </div>
            </li>

            <li>
                <div class="list-style">
                    <a href="/profile">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M234-276q51-39 114-59.5T480-356q71 0 134 20.5T728-276q35-41 53.5-93T800-480q0-133-93.5-226.5T480-800 253.5-706.5 160-480q0 59 19 111t53 93Zm246-164q-70 0-120-50t-50-120q0-70 50-120t120-50q70 0 120 50t50 120q0 70-50 120t-120 50Zm0 80q83 0 156-31.5T828-276q-31-36-104-67.5T568-375q-83 0-156 31.5T308-276q31 36 104 67.5T568-177Zm0-240q45 0 77.5-32.5T678-527q0-45-32.5-77.5T568-637q-45 0-77.5 32.5T458-527q0 45 32.5 77.5T568-417Zm0-180Zm0 360Z"/></svg>
                    <span>Profile</span>
                    </a>
                </div>
            </li>

            <li>
                <a href="test.html">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M212-172v-402l268-203 268 203v402H550v-248H410v248H212Z"/></svg>
                    <span>Test</span>
                </a>
            </li>
            
            <%if(locals.flag > 0){%>
            <hr>
            <li>
                <button onclick=toggleSubMenu(this) class="dropdown-button">
                    <span style="color:#929292; font-size: 16px;"><%=community.communityName%></span>
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="m480-555.69-184 184L267.69-400 480-612.31 692.31-400 664-371.69l-184-184Z"/></svg>
                </button>
                <ul class="sub-menu show">
                    <div>
                        <li>
                            <a href="/community/post/create/<%=community.communityName%>">
                                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M454-290h54v-162h162v-54H508v-164h-54v164H290v54h164v162Zm26.17 190q-78.81 0-148.21-29.91T211.23-211.1q-51.34-51.28-81.28-120.59Q100-401.01 100-479.83q0-79.07 29.97-148.69t81.35-121.13q51.38-51.5 120.59-80.92Q401.13-860 479.83-860q79.06 0 148.67 29.39 69.62 29.39 121.13 80.85 51.52 51.46 80.94 121.02Q860-559.18 860-480.09t-29.39 148.15q-29.39 69.06-80.84 120.49-51.44 51.44-120.98 81.45-69.55 30-148.62 30Z"/></svg>
                                <span>Create Post</span>
                            </a>
                        </li>
                        <li>
                            <a href="/community/post/createfile/<%=community.communityName%>">
                                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M480-480q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/></svg>
                                <span>Upload File</span>
                            </a>
                        </li>
                        <li>
                            <a href="/community/<%=community.communityName%>">
                                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h640q33 0 56.5 23.5T880-720v480q0 33-23.5 56.5T800-160H160Zm0-80h640v-480H160v480Zm320-240Z"/></svg>
                                <span>Community Posts</span>
                            </a>
                        </li>
                    </div>
                </ul>
            </li>
            <%}%>
            <hr>

            <li>
                <button onclick=toggleSubMenu(this) class="dropdown-button">
                    
                    <span style="color:#929292; font-size: 16px;">Communities</span>
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="m480-555.69-184 184L267.69-400 480-612.31 692.31-400 664-371.69l-184-184Z"/></svg>
                </button>
                <ul class="sub-menu show">
                    <div>
                        <li>
                            <a href="/community/addCommunity">
                                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M454-290h54v-162h162v-54H508v-164h-54v164H290v54h164v162Zm26.17 190q-78.81 0-148.21-29.91T211.23-211.1q-51.34-51.28-81.28-120.59Q100-401.01 100-479.83q0-79.07 29.97-148.69t81.35-121.13q51.38-51.5 120.59-80.92Q401.13-860 479.83-860q79.06 0 148.67 29.39 69.62 29.39 121.13 80.85 51.52 51.46 80.94 121.02Q860-559.18 860-480.09t-29.39 148.15q-29.39 69.06-80.84 120.49-51.44 51.44-120.98 81.45-69.55 30-148.62 30Z"/></svg>
                                <span>Create Community</span>
                            </a>
                        </li>
                        <li>
                            <a href="/community">
                                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M640-239q-33.78 0-63.39-10T523-278q39-47 62.5-97.78t23.5-104.5q0-53.72-23.5-104.22T523-682q24-19 53.61-29T640-721q100.43 0 170.72 70.28Q881-580.43 881-480q0 100.43-70.28 170.72Q740.43-239 640-239Zm-160-64q-37-32-59-77.5T399-480q0-54 22-99.5t59-77.5q37 32 59 77.5t22 99.5q0 54-22 99.5T480-303Zm-160 64q-100.43 0-170.72-70.28Q79-379.57 79-480q0-100.43 70.28-170.72Q219.57-721 320-721q33.78 0 63.39 10T437-682q-39 47-62.5 97.65Q351-533.7 351-480.12 351-420 373.5-368q22.5 52 60.5 91-23.12 18.74-52.37 28.37Q352.38-239 320-239Z"/></svg>
                                <span>Join Community</span>
                            </a>
                        </li>

                        <li>
                            <a href="/community/explore">
                                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M480-84q-82 0-154-31.5t-125.5-85Q147-254 115.5-326T84-480q0-82 31.5-154t85-125.5Q254-813 326-844.5T480-876q154 0 265.5 102T873-522h-54q-10-94-66-169T608-800v19q0 35-25.5 60.5T522-695h-84v86q0 17-12.5 29.5T396-567h-88v86h61v128h-18L146-558q-3 20-5.5 39t-2.5 39q0 141 99 241.5T480-137v53Zm356-41L696-263q-17 14-36.5 19t-39.5 5q-60 0-100.5-40.5T479-380q0-60 40.5-100.5T620-521q60 0 100.5 40.5T761-380q0 21-5.5 41.5T735-301l140 137-39 39ZM620-293q36 0 61.5-25.5T707-380q0-36-25.5-61.5T620-467q-36 0-61.5 25.5T533-380q0 36 25.5 61.5T620-293Z"/></svg>
                                <span>Explore Communities</span>
                            </a>
                        </li>

                        <li>
                            <a href="#">
                                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M358.14-326q-37.14 0-63.64-26.36t-26.5-63.5q0-37.14 26.36-63.64t63.5-26.5q37.14 0 63.64 26.36t26.5 63.5q0 37.14-26.36 63.64t-63.5 26.5ZM226-102q-36.73 0-61.36-24.64Q140-151.27 140-188v-508q0-36.72 24.64-61.36Q189.27-782 226-782h48v-88h58v88h300v-88h54v88h48q36.72 0 61.36 24.64T820-696v508q0 36.73-24.64 61.36Q770.72-102 734-102H226Zm0-54h508q12 0 22-10t10-22v-360H194v360q0 12 10 22t22 10Zm-32-446h572v-94q0-12-10-22t-22-10H226q-12 0-22 10t-10 22v94Zm0 0v-126 126Z"/></svg>
                                <span>Events</span>
                            </a>
                        </li>
                        <li><a href="#">Documents</a></li>
                    </div>
                </ul>
            </li>

            <hr>

            <li>
                <button onclick=toggleSubMenu(this) class="dropdown-button">
                    <span style="color:#929292; font-size: 16px;">More</span>
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="m480-555.69-184 184L267.69-400 480-612.31 692.31-400 664-371.69l-184-184Z"/></svg>
                </button>
                <ul class="sub-menu show">
                    <div>
                        <li>
                            <a href="#">
                                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M454-290h54v-230h-54v230Zm25.82-296q12.68 0 21.43-8.57 8.75-8.58 8.75-21.25 0-12.68-8.57-21.43-8.58-8.75-21.25-8.75-12.68 0-21.43 8.57-8.75 8.58-8.75 21.25 0 12.68 8.57 21.43 8.58 8.75 21.25 8.75Zm.35 486q-78.81 0-148.21-29.91T211.23-211.1q-51.34-51.28-81.28-120.59Q100-401.01 100-479.83q0-79.07 29.97-148.69t81.35-121.13q51.38-51.5 120.59-80.92Q401.13-860 479.83-860q79.06 0 148.67 29.39 69.62 29.39 121.13 80.85 51.52 51.46 80.94 121.02Q860-559.18 860-480.09t-29.39 148.15q-29.39 69.06-80.84 120.49-51.44 51.44-120.98 81.45-69.55 30-148.62 30Zm-.17-54q136.51 0 231.26-94.74Q806-343.49 806-480t-94.74-231.26Q616.51-806 480-806t-231.26 94.74Q154-616.51 154-480t94.74 231.26Q343.49-154 480-154Zm0-326Z"/></svg>
                                <span>About Us</span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M481.92-258q15.08 0 25.58-10.42 10.5-10.41 10.5-25.5 0-15.08-10.42-25.58-10.41-10.5-25.5-10.5-15.08 0-25.58 10.42-10.5 10.41-10.5 25.5 0 15.08 10.42 25.58 10.41 10.5 25.5 10.5ZM454-398h52q2-28.65 9.5-46.82Q523-463 552-492q27-25 40.5-47.92t13.5-52.64q0-50.44-36.25-79.94Q533.51-702 484-702q-48 0-81 25.5T356-616l48 20q8-22 25-40t53-18q38 0 56 21t18 45q0 21-12 37t-30 33q-38 35-49 58t-11 62Zm26.17 298q-78.81 0-148.21-29.91T211.23-211.1q-51.34-51.28-81.28-120.59Q100-401.01 100-479.83q0-79.07 29.97-148.69t81.35-121.13q51.38-51.5 120.59-80.92Q401.13-860 479.83-860q79.06 0 148.67 29.39 69.62 29.39 121.13 80.85 51.52 51.46 80.94 121.02Q860-559.18 860-480.09t-29.39 148.15q-29.39 69.06-80.84 120.49-51.44 51.44-120.98 81.45-69.55 30-148.62 30Zm-.17-54q136.51 0 231.26-94.74Q806-343.49 806-480t-94.74-231.26Q616.51-806 480-806t-231.26 94.74Q154-616.51 154-480t94.74 231.26Q343.49-154 480-154Zm0-326Z"/></svg>
                                <span>Help</span>
                            </a>
                        </li>
                    </div>
                </ul>
            </li>
            </ul>
        </nav>
    </div>
    <div id="display-container" class="display-container">
        <div class="comments-wrapper">
            <!-- Original Post Section -->
            <div class="original-post">
                <div class="post-header">
                    <div class="post-user-info">
                        <img src="<%= userProfile.picture_name%>" alt="User Profile" class="user-avatar">
                        <div class="post-meta">
                            <span class="username"><%= user.name %></span>
                            <!-- <span class="post-time">Posted <%= new Date(post.createdAt).toLocaleString() %></span> -->
                            <span class="community-name">r/<%= community.communityName %></span>
                        </div>
                    </div>
                </div>
                <div class="post-content">
                    <h2 class="post-title"><%= post.title %></h2>
                    <% if (post.path) { %>
                        <p class="post-text"><%= post.caption %></p>
                        <div class="post-media-container">
                            <img src="<%= post.path %>" alt="Post Image" class="post-media">
                        </div>
                    <% } else { %>
                        <p class="post-text"><%= post.postText %></p>
                    <% } %>
                    <div class="post-vote-section">
                        <div class="vote-count">
                            <span class="vote-number"><%= post.upVote %></span>
                            <span class="vote-label">votes</span>
                        </div>
                        <div class="vote-buttons">
                            <button class="vote-btn upvote" onclick="window.location.href='/upvote/<%=flag%>/<%=community._id%>/<%=post._id%>'">
                                <i class="fas fa-arrow-up"></i>
                                <span>Upvote</span>
                            </button>
                            <button class="vote-btn downvote">
                                <i class="fas fa-arrow-down"></i>
                                <span>Downvote</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Comment Input Section -->
            <div class="comment-input-section">
                <div class="comment-input-wrapper">
                    <img src="<%= curr_profile.picture_name %>" alt="Your Profile" class="user-avatar">
                    <div class="comment-input-container">
                        <form id="commentForm" action="/comments/<%= community._id %>/<%= post._id %>" method="POST">
                            <textarea 
                                name="commentText" 
                                placeholder="Write a comment..." 
                                required
                                class="comment-input"
                                rows="1"
                                oninput="this.style.height = '';this.style.height = this.scrollHeight + 'px'"
                            ></textarea>
                            <div class="comment-actions">
                                <button type="button" class="cancel-btn">Cancel</button>
                                <button type="submit" class="submit-btn">Comment</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Comments Display Section -->
            <div class="comments-section">
                <% if (comments && comments.length > 0) { %>
                    <% comments.forEach(comment => { %>
                        <div class="comment-item" data-comment-id="<%= comment._id %>">
                            <div class="comment-header">
                                <% userProfileComments.forEach(user => { %>
                                    <% if (user.user_id.toString() === comment.user_id.toString()) { %>
                                            <img src="<%= user.picture_name %>" alt="Commenter Profile" class="user-avatar">
                                    <%}%>
                                <% }) %>
                                <div class="comment-meta">
                                    <% userComment.forEach(user => { %>
                                        <% if (user._id.toString() === comment.user_id.toString()) { %>
                                            <span class="username"><%= user.name %></span>
                                        <%}%>
                                    <%})%>
                                </div>
                            </div>
                            <div class="comment-content">
                                <p><%= comment.comment_text %></p>
                            </div>
                            <div class="comment-actions">
                                <button class="vote-btn upvote">
                                    <i class="fas fa-arrow-up"></i>
                                    <span><%= comment.upVotes %></span>
                                </button>
                                <button class="vote-btn downvote">
                                    <i class="fas fa-arrow-down"></i>
                                    <span>DownVote</span>
                                </button>
                                <button class="reply-btn">
                                    <i class="fas fa-reply"></i>
                                    Reply
                                </button>
                            </div>
                        </div>
                    <% }); %>
                <% } else { %>
                    <div class="no-comments">
                        <p>No comments yet. Be the first to comment!</p>
                    </div>
                <% } %>
            </div>
        </div>
    </div>

    <style>
        .comments-wrapper {
            max-width: 1150px;
            margin: 0 auto;
            padding: 20px;
            animation: fadeIn 0.3s ease-in-out;
            background: linear-gradient(180deg, #1a1a1a 0%, #1c1c1c 100%);
            min-height: 100vh;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .original-post {
            background: linear-gradient(145deg, #1c1c1c, #1a1a1a);
            border-radius: 16px;
            padding: 28px;
            margin-bottom: 28px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .original-post::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #0079d3, #00b4d8);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .original-post:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.25);
        }

        .original-post:hover::before {
            opacity: 1;
        }

        .post-header {
            display: flex;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .post-user-info {
            display: flex;
            align-items: center;
            gap: 16px;
            width: 100%;
        }

        .user-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .user-avatar:hover {
            transform: scale(1.1) rotate(5deg);
            border-color: #0079d3;
        }

        .post-meta {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .username {
            color: #e3e3e3;
            font-weight: 600;
            font-size: 1.2rem;
            transition: all 0.2s ease;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .username:hover {
            color: #0079d3;
            transform: translateX(4px);
        }

        .post-time {
            color: #888;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .post-time::before {
            content: '•';
            color: #666;
        }

        .post-content {
            color: #e3e3e3;
        }

        .post-title {
            margin-bottom: 20px;
            font-size: 1.8rem;
            font-weight: 700;
            color: #ffffff;
            line-height: 1.3;
            letter-spacing: -0.5px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .post-text {
            margin-bottom: 24px;
            line-height: 1.7;
            font-size: 1.1rem;
            color: #e0e0e0;
            letter-spacing: 0.2px;
        }

        .post-media {
            max-width: 100%;
            border-radius: 12px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .post-media:hover {
            transform: scale(1.02);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
        }

        .comment-input-section {
            background: linear-gradient(145deg, #1c1c1c, #1a1a1a);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 28px;
            transition: all 0.3s ease;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .comment-input-section:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.2);
            border-color: rgba(255, 255, 255, 0.1);
        }

        .comment-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .comment-input-wrapper {
            display: flex;
            gap: 16px;
            align-items: flex-start;
        }

        .comment-input-container {
            flex: 1;
            position: relative;
            background: #2d2d2d;
            border-radius: 12px;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .comment-input {
            width: 100%;
            background: transparent;
            border: none;
            border-radius: 12px;
            padding: 16px;
            color: #e3e3e3;
            resize: none;
            min-height: 48px;
            font-family: inherit;
            font-size: 1.1rem;
            line-height: 1.6;
            transition: all 0.3s ease;
            cursor: pointer;
            box-sizing: border-box;
        }

        .comment-input:focus {
            outline: none;
        }

        .comment-actions {
            margin-left: 64px;
            display: flex;
            gap: 20px;
            align-items: center;
            padding: 12px 0;
            opacity: 1;
            visibility: visible;
            height: auto;
            transform: none;
        }

        .vote-btn, .reply-btn {
            background: rgba(45, 45, 45, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.05);
            color: #888;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .vote-btn:hover, .reply-btn:hover {
            background: rgba(45, 45, 45, 0.8);
            color: #e3e3e3;
            transform: translateY(-2px);
            border-color: rgba(255, 255, 255, 0.1);
        }

        .vote-btn:active, .reply-btn:active {
            transform: translateY(0);
        }

        .vote-btn i, .reply-btn i {
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .vote-btn:hover i {
            transform: scale(1.2);
        }

        .upvote:hover {
            color: #4CAF50;
        }

        .downvote:hover {
            color: #f44336;
        }

        .reply-btn:hover i {
            transform: translateX(4px);
        }

        @media (max-width: 768px) {
            .comment-actions {
                margin-left: 0;
                padding: 8px 0;
            }

            .vote-btn, .reply-btn {
                padding: 6px 12px;
                font-size: 0.85rem;
            }
        }

        .no-comments {
            text-align: center;
            color: #888;
            padding: 60px 0;
            font-size: 1.2rem;
            animation: fadeIn 0.3s ease-in-out;
            background: linear-gradient(145deg, #1c1c1c, #1a1a1a);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .portrait {
            max-height: 600px;
            width: auto;
            margin: 0 auto;
            display: block;
            border-radius: 16px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
        }

        /* Loading animation for submit button */
        @keyframes loading {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .submit-btn.loading {
            position: relative;
            color: transparent;
        }

        .submit-btn.loading::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: loading 0.8s linear infinite;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .comments-wrapper {
                padding: 16px;
            }

            .post-title {
                font-size: 1.5rem;
            }

            .comment-content {
                margin-left: 0;
            }

            .comment-actions {
                margin-left: 0;
            }

            .comment-input-wrapper {
                flex-direction: column;
            }

            .user-avatar {
                width: 40px;
                height: 40px;
            }

            .cancel-btn, .submit-btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }

            .post-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }

            .post-vote-actions {
                width: 100%;
                justify-content: flex-end;
            }
        }

        /* Dark scrollbar */
        .comments-wrapper::-webkit-scrollbar {
            width: 10px;
        }

        .comments-wrapper::-webkit-scrollbar-track {
            background: #1a1a1a;
        }

        .comments-wrapper::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 5px;
            border: 2px solid #1a1a1a;
        }

        .comments-wrapper::-webkit-scrollbar-thumb:hover {
            background: #444;
        }

        /* Glass morphism effect for hover states */
        .comment-item:hover, .original-post:hover {
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        /* Custom selection color */
        ::selection {
            background: rgba(0, 121, 211, 0.3);
            color: #ffffff;
        }

        .post-vote-section {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }

        .vote-count {
            display: flex;
            align-items: baseline;
            gap: 8px;
        }

        .vote-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: #e3e3e3;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .vote-label {
            font-size: 1rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .vote-buttons {
            display: flex;
            gap: 12px;
        }

        .vote-buttons .vote-btn {
            background: rgba(45, 45, 45, 0.5);
            padding: 10px 20px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-size: 0.9rem;
        }

        .vote-buttons .vote-btn:hover {
            background: rgba(45, 45, 45, 0.8);
            transform: translateY(-2px);
            border-color: rgba(255, 255, 255, 0.1);
        }

        .vote-buttons .vote-btn:active {
            transform: translateY(0);
        }

        .vote-buttons .vote-btn i {
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .vote-buttons .vote-btn:hover i {
            transform: scale(1.2);
        }

        .vote-buttons .upvote:hover {
            color: #4CAF50;
        }

        .vote-buttons .downvote:hover {
            color: #f44336;
        }

        @media (max-width: 768px) {
            .post-vote-section {
                flex-direction: column;
                gap: 16px;
                align-items: center;
            }

            .vote-buttons {
                width: 100%;
                justify-content: center;
            }

            .vote-buttons .vote-btn {
                padding: 8px 16px;
                font-size: 0.85rem;
            }
        }

        .community-name {
            color: #0079d3;
            font-size: 0.9rem;
            font-weight: 500;
            margin-left: 8px;
            padding: 2px 8px;
            background: rgba(0, 121, 211, 0.1);
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .community-name:hover {
            background: rgba(0, 121, 211, 0.2);
            transform: translateX(4px);
        }
    </style>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-expand textarea and handle button visibility
            const textarea = document.querySelector('.comment-input');
            const commentActions = document.querySelector('.comment-actions');
            
            function showCommentActions() {
                commentActions.classList.add('show');
            }

            function hideCommentActions() {
                commentActions.classList.remove('show');
            }

            // Show buttons only on textarea focus
            textarea.addEventListener('focus', showCommentActions);
            
            // Handle text input
            textarea.addEventListener('input', function() {
                this.style.height = '';
                this.style.height = this.scrollHeight + 'px';
            });

            // Handle comment form submission
            const commentForm = document.getElementById('commentForm');
            if (commentForm) {
                commentForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const submitBtn = this.querySelector('.submit-btn');
                    const commentText = textarea.value;
                    
                    if (!commentText.trim()) {
                        alert('Please enter a comment');
                        return;
                    }
                    
                    // Show loading state
                    submitBtn.classList.add('loading');
                    submitBtn.disabled = true;
                    
                    try {
                        const response = await fetch(this.action, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({ commentText })
                        });
                        
                        if (response.ok) {
                            // Clear the input and reset height
                            textarea.value = '';
                            textarea.style.height = 'auto';
                            hideCommentActions();
                            
                            // Refresh the comments section
                            window.location.reload();
                        } else {
                            throw new Error('Failed to post comment');
                        }

                    } catch (error) {
                        console.error('Error posting comment:', error);
                        alert(error.message || 'Failed to post comment. Please try again.');
                    } 
                    
                    finally {
                        // Reset button state
                        submitBtn.classList.remove('loading');
                        submitBtn.disabled = false;
                    }
                });
            }

            // Handle cancel button
            const cancelBtn = document.querySelector('.cancel-btn');
            if (cancelBtn) {
                cancelBtn.addEventListener('click', function() {
                    textarea.value = '';
                    textarea.style.height = 'auto';
                    hideCommentActions();
                });
            }

            // Handle vote buttons
            document.querySelectorAll('.vote-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const isUpvote = this.classList.contains('upvote');
                    const commentId = this.closest('.comment-item').dataset.commentId;
                    const voteCount = this.querySelector('span');
                    
                    // Add your vote handling logic here
                    // For now, just update the UI
                    let count = parseInt(voteCount.textContent);
                    if (isUpvote) {
                        voteCount.textContent = count + 1;
                    } else {
                        voteCount.textContent = count - 1;
                    }
                });
            });

            // Handle reply buttons
            document.querySelectorAll('.reply-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const commentId = this.closest('.comment-item').dataset.commentId;
                    // Add your reply handling logic here
                    alert('Reply feature coming soon!');
                });
            });

            // Function to toggle no comments message
            function toggleNoComments() {
                const commentsExist = document.querySelectorAll('.comment-item').length > 0;
                document.querySelector('.no-comments').style.display = 
                    commentsExist ? 'none' : 'block';
            }

            // Call initially
            toggleNoComments();

            // Handle post vote buttons
            document.querySelectorAll('.post-vote-section .vote-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const isUpvote = this.classList.contains('upvote');
                    const voteNumber = document.querySelector('.vote-number');
                    let count = parseInt(voteNumber.textContent);
                    
                    // Update vote count (prevent negative values)
                    if (isUpvote) {
                        count++;
                    } else {
                        count = Math.max(0, count - 1); // Prevent negative values
                    }
                    
                    voteNumber.textContent = count;
                    
                    // Update button states
                    const upvoteBtn = document.querySelector('.post-vote-section .upvote');
                    const downvoteBtn = document.querySelector('.post-vote-section .downvote');
                    
                    if (isUpvote) {
                        upvoteBtn.style.color = '#4CAF50';
                        downvoteBtn.style.color = '#888';
                    } else {
                        upvoteBtn.style.color = '#888';
                        downvoteBtn.style.color = count > 0 ? '#f44336' : '#888';
                    }
                });
            });
        });
    </script>
        
  </body>
</html>
